# i3 config file (v4).
# vim: set foldmethod=marker :
#
# see http://i3wm.org/docs/userguide.html for a complete reference
#

## Local variables {{{
# i3's variables aren't particularly great. i.e., you can't set a
# variable to a variable, and quoting and whatnot is really weird and I
# generally don't trust it.
# --no-startup-id disables startup notifications for that window, so we
# don't get the hourglass pointer for 60 secs
# see https://faq.i3wm.org/question/561
set $exec exec --no-startup-id

# v - this does NOT work! - v
#set $i3_msg $exec i3-msg
set $i3_msg exec --no-startup-id i3-msg

# set i3 config directory
set $conf_dir ~/.config/i3

# set monitor names
set $mon_primary eDP1
set $mon_secondary HDMI1
## }}}

## Appearance {{{
# font for window titles. Will also be used by the bar unless a
# different font is defined in the bar {} block below.
# DejaVu Sans Mono provides lots of Unicode glyphs, right-to-text
# rendering and looks nice.
#font pango:DejaVu Sans Mono 10
# Terminus is for hackers only 8)
font pango:xos4 Terminus 10

### Window decorations/colours {{{
# disable titlebar
# suggest against this due to some title bars being pretty helpful
#new_window 1pixel

# Note: the quotes are actually optional, but they help Vim understand that
# they're strings, not comments

#### Default colours {{{
# class                 border    backgrnd. text      indicator
#client.focused          "#4c7899" "#285577" "#ffffff" "#2e9ef4"
#client.focused_inactive "#333333" "#5f676a" "#ffffff" "#484e50"
#client.unfocused        "#333333" "#222222" "#888888" "#292d2e"
#client.urgent           "#2f343a" "#900000" "#ffffff" "#900000"
#client.placeholder      "#000000" "#0c0c0c" "#ffffff" "#000000"
#### }}}

set $clr_foc_text "#dddddd"
set $clr_unfoc_text "#777777"

set $clr_foc_border "#4c6088"
set $clr_foc_bg "#2a3d5d"

set $clr_unfoc_border "#242424"
set $clr_unfoc_bg "#1a1a1a"

set $clr_inactive_border "#444444"
set $clr_inactive_bg "#353535"
set $clr_inactive_text "#cccccc"

# class                 border    backgrnd. text      indicator
client.focused          $clr_foc_border $clr_foc_bg $clr_foc_text "#4477aa"
client.focused_inactive $clr_inactive_border $clr_inactive_bg $clr_inactive_text "#333333"
client.unfocused        $clr_unfoc_border $clr_unfoc_bg $clr_unfoc_text "#292d2e"
client.urgent           "#2f343a" "#900000" $clr_foc_text "#900000"
client.placeholder      "#000000" "#0c0c0c" $clr_foc_text "#000000"
#### }}}

### }}}
## }}}

## Programs {{{
# (suggested absolute paths so no one can mess with them)
set $terminal /usr/bin/urxvtc
set $browser /usr/bin/firefox
## }}}

## Modes {{{
# resize mode (can also use $mod + right/left click)
mode "resize" {
    # note: mode bindings only apply while the mode is active

    # grow/shrink (from top-left i.e. down, right = grow)
    # (shifted Vim keys)
    bindsym j         resize shrink width  10 px or 10 ppt
    bindsym k         resize grow   height 10 px or 10 ppt
    bindsym l         resize shrink height 10 px or 10 ppt
    bindsym semicolon resize grow   width  10 px or 10 ppt

    # grow/shrink (from top-left i.e. down, right = grow)
    # (arrow keys)
    bindsym Left  resize shrink width  10 px or 10 ppt
    bindsym Down  resize grow   height 10 px or 10 ppt
    bindsym Up    resize shrink height 10 px or 10 ppt
    bindsym Right resize grow   width  10 px or 10 ppt

    # back to normal: Enter or Escape
    bindsym Return mode "default"
    bindsym Escape mode "default"
}

set $no_swallow "no-swallow - $mod+Shift+Esc to exit"
mode $no_swallow {
    # only keybind is one to return to normal
    bindsym $mod+Shift+Escape mode "default"
}
## }}}

## Keybinds {{{
### Modifiers {{{
# main i3 modifier key
# Mod4 = Win
set $mod Mod4

# more descriptive name for Alt
set $alt Mod1

# drag floating windows with mouse + floating_modifier
floating_modifier $mod
### }}}

### Programs {{{
# start a terminal
bindsym $mod+Return exec $terminal

# start browser
bindsym $mod+Shift+Return exec $browser

# start dmenu (program launcher)
bindsym $mod+d exec dmenu_run

# start Anki
bindsym $mod+Shift+a exec anki
### }}}

### Moving workspaces {{{
# switch to workspace [beginning with] X
bindsym $mod+1 workspace number 1
bindsym $mod+2 workspace number 2
bindsym $mod+3 workspace number 3
bindsym $mod+4 workspace number 4
bindsym $mod+5 workspace number 5
bindsym $mod+6 workspace number 6
bindsym $mod+7 workspace number 7
bindsym $mod+8 workspace number 8
bindsym $mod+9 workspace number 9
bindsym $mod+0 workspace number 10

# switch to previous workspace
bindsym $mod+z workspace back_and_forth

# move focused container to workspace [beginning with] X
bindsym $mod+Shift+1 move container to workspace number 1
bindsym $mod+Shift+2 move container to workspace number 2
bindsym $mod+Shift+3 move container to workspace number 3
bindsym $mod+Shift+4 move container to workspace number 4
bindsym $mod+Shift+5 move container to workspace number 5
bindsym $mod+Shift+6 move container to workspace number 6
bindsym $mod+Shift+7 move container to workspace number 7
bindsym $mod+Shift+8 move container to workspace number 8
bindsym $mod+Shift+9 move container to workspace number 9
bindsym $mod+Shift+0 move container to workspace number 10

# move focused container to previous workspace
bindsym $mod+Shift+z move container to workspace back_and_forth

# move workspace to another output
# rolls over e.g. if only 2 outputs, left & right are identical
bindsym $mod+x move workspace to output right
### }}}

### Moving windows {{{
# change focus window (shifted Vim keys)
bindsym $mod+j focus left
bindsym $mod+k focus down
bindsym $mod+l focus up
bindsym $mod+semicolon focus right

# change focus window (arrow keys)
bindsym $mod+Left focus left
bindsym $mod+Down focus down
bindsym $mod+Up focus up
bindsym $mod+Right focus right

# change focus window to latest urgent window
bindsym $mod+u [urgent=latest] focus

# move focused window (shifted Vim keys)
bindsym $mod+Shift+j move left
bindsym $mod+Shift+k move down
bindsym $mod+Shift+l move up
bindsym $mod+Shift+semicolon move right

# move focused window (arrow keys)
bindsym $mod+Shift+Left move left
bindsym $mod+Shift+Down move down
bindsym $mod+Shift+Up move up
bindsym $mod+Shift+Right move right

# move floating window to centre of monitor
bindsym $mod+Shift+c move position center
### }}}

### Windows {{{
# split in horizontal orientation
bindsym $mod+h split h

# split in vertical orientation
bindsym $mod+v split v

# enter fullscreen mode for the focused container
bindsym $mod+f fullscreen

# change container layout (stacked, tabbed, toggle split)
bindsym $mod+s layout stacking
bindsym $mod+w layout tabbed
bindsym $mod+e layout toggle split

# toggle tiling / floating
bindsym $mod+Shift+space floating toggle

# change focus between tiling / floating windows
bindsym $mod+space focus mode_toggle

# make current window a scratchpad
bindsym $mod+Shift+minus move scratchpad

# show first scratchpad window
bindsym $mod+minus scratchpad show

# focus the parent container
bindsym $mod+a focus parent

# focus the child container
#bindsym $mod+d focus child

# kill focused window
bindsym $mod+Shift+q kill
### }}}

### i3 {{{
# reload i3 config file (i.e. this file)
bindsym $mod+Shift+r reload

# restart i3 in-place (preserves your layout & session, can be used to
# upgrade i3)
bindsym $mod+Control+Shift+r restart

# exit i3 (exits X too)
bindsym $mod+Shift+e exit
### }}}

### Modes {{{
# enter resize mode
bindsym $mod+r mode "resize"

# enter no-swallow mode
bindsym $mod+Shift+Escape mode $no_swallow
### }}}

### Multimedia {{{
# send SIGUSR1 to i3status to refresh it manually
#set $refresh killall -USR1 i3status

# set i3blocks refresh commands
set $refresh_mpd pkill -RTMIN+10 i3blocks
set $refresh_vol pkill -RTMIN+11 i3blocks

# volume multimedia keys -- ALSA
#bindsym XF86AudioRaiseVolume $exec "amixer -M set Master 1dB+ && $refresh"
#bindsym XF86AudioLowerVolume $exec "amixer -M set Master 1dB- && $refresh"
#bindsym XF86AudioMute $exec "amixer set Master toggle && $refresh"

# volume multimedia keys -- PulseAudio
bindsym XF86AudioRaiseVolume $exec "amixer set Master 2%+ && $refresh_vol"
bindsym XF86AudioLowerVolume $exec "amixer set Master 2%- && $refresh_vol"
bindsym XF86AudioMute $exec "amixer set Master toggle && $refresh_vol"

# MPD volume keybinds
bindsym $mod+XF86AudioRaiseVolume $exec "mpc volume +2 && $refresh_vol"
bindsym $mod+XF86AudioLowerVolume $exec "mpc volume -2 && $refresh_vol"

# special multimedia keys
bindsym XF86AudioPlay $exec "mpc toggle && $refresh_mpd"
bindsym XF86AudioStop $exec "mpc stop && $refresh_mpd"
bindsym XF86AudioPrev $exec "mpc prev && $refresh_mpd"
bindsym XF86AudioNext $exec "mpc next && $refresh_mpd"

# special MPD keys
bindsym $mod+XF86AudioNext $exec "mpd-insert-best"

# brightness keys
bindsym XF86MonBrightnessUp $exec "xbacklight -time 0 -steps 1   -inc 10"
bindsym XF86MonBrightnessDown $exec "xbacklight -time 0 -steps 1 -dec 10"
### }}}

### Screenshots {{{
# set shot options & directory
set $shot maim -n -b2 $HOME/media/screenshots/$(date +%F_%T_shot).png

# capture currently focused window
bindsym Print $exec $shot -i $(xdotool getactivewindow)

# capture a selection
bindsym Ctrl+Print $exec $shot -s

# capture all screens together
bindsym Shift+Print $exec $shot

# custom shots
bindsym $mod+Print $exec shot-cs-manual
### }}}

### Computer {{{
# turn off screen
bindsym $mod+F2 $exec "scr"

# lock computer
bindsym XF86Display $exec "lock"

# turn off computer
bindsym $mod+Shift+Delete $exec "poweroff"

# turn off touchpad
bindsym $mod+F6 $exec "touchpad-toggle"

# lock computer & standby
bindsym $mod+F1 $exec "lockstb"
### }}}

### Etc. {{{
# 'swap' outputs
bindsym $mod+Shift+x exec "outswap"
### }}}
## }}}

## Behaviour {{{
# enable back and forth (hitting the bindsym for your current workspace
# will switch you to your previous workspace)
#workspace_auto_back_and_forth yes

# set default output (monitor) for each workspace
# looks like workspace number doesn't work here :/
workspace 1 output $mon_primary
workspace 2 output $mon_primary
workspace 3 output $mon_secondary
workspace 4 output $mon_secondary

### Assigns {{{
# start Anki on workspace 5
#assign [class="Anki"] 5

# start pavucontrol floating
for_window [class="Pavucontrol"] floating enable

# Steam floats by default, so that chat windows don't annoy you
for_window [class="Steam"] floating enable

# temp./test
assign [title="^watch-then-move"] 3
### }}}
## }}}

## Bar {{{
bar {
    # pipe to my wrapper script (inserts extra bits)
    #status_command i3status | i3status-wrapper.py
    status_command i3blocks

    # system tray on primary monitor plz
    tray_output primary

    # set default statusline colour
    colors {
        background "#000000"
        statusline $clr_foc_text
        #separator "#666666"

        focused_workspace $clr_foc_border $clr_foc_bg $clr_foc_text
        active_workspace $clr_inactive_border $clr_inactive_bg $clr_inactive_text
        inactive_workspace $clr_unfoc_border $clr_unfoc_bg $clr_unfoc_text
        #urgent_workspace "#2f343a" "#900000" "#ffffff"
    }
}
## }}}

## Autostarting {{{
### Applications {{{
# Things to remember:
#
#   * prefix exec with a switch to the workspace you want the program on
#   * remember to title things when required by your layouts
#   * the selected window for a workspace seems pretty hard to set -
#     the order in which you start things might have an effect, but it
#     doesn't seem reliable
#
$i3_msg 'workspace number 1; exec $terminal -title "work"'
$i3_msg 'workspace number 2; exec $browser'
$i3_msg 'workspace number 3; exec $terminal -title "email" -e email'
$i3_msg 'workspace number 3; exec $terminal -title "irc" -e weechat'
$i3_msg 'workspace number 4; exec $terminal -title "music" -e mpn'
#$i3_msg 'workspace number 10; exec $terminal -title "wyrd" -e wyrd-fix-startup'
### }}}

### Layouts {{{
# Note: there is no point in using a layout if a workspace has just 1
#       window
#
# Remember to prefix the layout with a change to the wanted workspace!
# Keep in mind that the last workspace to have a layout appended to it
# will probably be the active one on startup.
#
$i3_msg 'workspace number 3; append_layout "$conf_dir/workspace-3"'

# try to make a specific workspace active on startup
$i3_msg 'workspace number 1'

### }}}
## }}}
