#!/usr/bin/python3
#
# Tweet.
#
# Requires twitter (Python Twitter Tools), NOT python-twitter.
#

import os

# twitter requires a json module
# simplejson is updated more and may be faster
# see: http://stackoverflow.com/questions/712791
import simplejson
import twitter

import sys



# your application keys (make an app at apps.twitter.com)
consumer_key = 'zs4Ok2mUwJT3u4oyqZnQqf46t'
consumer_secret = 'W5tacMrtLR2m6qOh6PgNipWiIERBVar83mexwSeVi5QTfAEjEp'

# user credential file location
oauth_filename = os.getenv('HOME')+"/.twitterminal_creds"



# check above keys are present so we don't inconvenience Twitter for no reason
if (consumer_key == '') or (consumer_secret == ''):
    print(sys.argv[0] + ": error: no API keys present (go to apps.twitter.com to generate some)")
    sys.exit(1)

# if we don't get a string, complain about it
if not len(sys.argv) > 1:
    print(sys.argv[0] + ": error: no string passed")
    sys.exit(1)



# redo OAuth biz (nice & automated) if we can't find an OAuth credentials file
if not os.path.exists(oauth_filename):
    # also writes creds to oauth_filename, usefully
    twitter.oauth_dance('twitterminal', consumer_key, consumer_secret, oauth_filename)



# finally actually do the tweeting biz
oauth_token, oauth_token_secret = twitter.read_token_file(oauth_filename)
twat = twitter.Twitter(auth=twitter.OAuth(oauth_token, oauth_token_secret, consumer_key, consumer_secret))

# update status with whatever is in argument 1
twat.statuses.update(status=sys.argv[1])
