#!/usr/bin/bash
#
# Tweet about the last commit in a Git repo.
#

# if we're given an argument, assume it's a git repo and cd to it
# otherwise we'll hope that we're already in a git repo ;)
if [ -n "$1" ]; then
    cd "$1"
fi

# get a ton of info
git_root="$(basename "$(git rev-parse --show-toplevel)")"
last_hash_short="$(git rev-parse --short HEAD)"
last_hash_full="$(git rev-parse HEAD)"
last_message="$(git log -1 --pretty=%s)"
last_author="$(git log -1 --pretty=%aN)"

tweet "\"${last_message}\" - commit $last_hash_short by $last_author @ raehik/$git_root (https://github.com/raehik/$git_root/commit/$last_hash_full"
